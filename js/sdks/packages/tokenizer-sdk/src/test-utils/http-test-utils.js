"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.verifyHeaders = exports.verifySecretHeader = void 0;
const constants_1 = require("../constants");
const test_constants_1 = require("./test-constants");
function verifySecretHeader(test, secret = test_constants_1.TEST_TOKENIZER_SECRET) {
    return async (req) => {
        test.equal(req.headers[constants_1.CONFIG_DEFAULTS.headers.auth], secret, 'secret header passed correctly');
    };
}
exports.verifySecretHeader = verifySecretHeader;
function verifyHeaders(test, headers) {
    return async (req) => {
        Object.keys(headers).forEach((header) => test.equal(req.headers[header], headers[header], `header matches: ${header}`));
    };
}
exports.verifyHeaders = verifyHeaders;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaHR0cC10ZXN0LXV0aWxzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiaHR0cC10ZXN0LXV0aWxzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUNBLDRDQUErQztBQUMvQyxxREFBeUQ7QUFHekQsU0FBZ0Isa0JBQWtCLENBQUMsSUFBZSxFQUFFLFNBQWlCLHNDQUFxQjtJQUN4RixPQUFPLEtBQUssRUFBRSxHQUFvQixFQUFFLEVBQUU7UUFDcEMsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLDJCQUFlLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxFQUFFLE1BQU0sRUFBRSxnQ0FBZ0MsQ0FBQyxDQUFDO0lBQ2xHLENBQUMsQ0FBQztBQUNKLENBQUM7QUFKRCxnREFJQztBQUVELFNBQWdCLGFBQWEsQ0FBQyxJQUFlLEVBQUUsT0FBK0I7SUFDNUUsT0FBTyxLQUFLLEVBQUUsR0FBb0IsRUFBRSxFQUFFO1FBQ3BDLE1BQU0sQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsTUFBTSxFQUFFLEVBQUUsQ0FDdEMsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQyxFQUFFLE9BQU8sQ0FBQyxNQUFNLENBQUMsRUFBRSxtQkFBbUIsTUFBTSxFQUFFLENBQUMsQ0FDOUUsQ0FBQztJQUNKLENBQUMsQ0FBQztBQUNKLENBQUM7QUFORCxzQ0FNQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBleHByZXNzIGZyb20gJ2V4cHJlc3MnO1xuaW1wb3J0IHsgQ09ORklHX0RFRkFVTFRTIH0gZnJvbSAnLi4vY29uc3RhbnRzJztcbmltcG9ydCB7IFRFU1RfVE9LRU5JWkVSX1NFQ1JFVCB9IGZyb20gJy4vdGVzdC1jb25zdGFudHMnO1xuaW1wb3J0IHRhcGUgZnJvbSAndGFwZSc7XG5cbmV4cG9ydCBmdW5jdGlvbiB2ZXJpZnlTZWNyZXRIZWFkZXIodGVzdDogdGFwZS5UZXN0LCBzZWNyZXQ6IHN0cmluZyA9IFRFU1RfVE9LRU5JWkVSX1NFQ1JFVCkge1xuICByZXR1cm4gYXN5bmMgKHJlcTogZXhwcmVzcy5SZXF1ZXN0KSA9PiB7XG4gICAgdGVzdC5lcXVhbChyZXEuaGVhZGVyc1tDT05GSUdfREVGQVVMVFMuaGVhZGVycy5hdXRoXSwgc2VjcmV0LCAnc2VjcmV0IGhlYWRlciBwYXNzZWQgY29ycmVjdGx5Jyk7XG4gIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB2ZXJpZnlIZWFkZXJzKHRlc3Q6IHRhcGUuVGVzdCwgaGVhZGVyczogUmVjb3JkPHN0cmluZywgc3RyaW5nPikge1xuICByZXR1cm4gYXN5bmMgKHJlcTogZXhwcmVzcy5SZXF1ZXN0KSA9PiB7XG4gICAgT2JqZWN0LmtleXMoaGVhZGVycykuZm9yRWFjaCgoaGVhZGVyKSA9PlxuICAgICAgdGVzdC5lcXVhbChyZXEuaGVhZGVyc1toZWFkZXJdLCBoZWFkZXJzW2hlYWRlcl0sIGBoZWFkZXIgbWF0Y2hlczogJHtoZWFkZXJ9YClcbiAgICApO1xuICB9O1xufVxuIl19